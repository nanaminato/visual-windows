<div class="folder-list-wrapper" (contextmenu)="onWrapperRightClick($event)">
    <div class="folder-area">
        <div class="folder-list-table flex-grow-1" role="grid" aria-label="æ–‡ä»¶åˆ—è¡¨">
            <!-- è¡¨å¤´ -->
            <div class="folder-list-header d-flex sticky-top bg-white">
                <div class="folder-list-col name-col" style="width: 40%;">åç§°</div>
                <div class="folder-list-col modified-col" style="width: 20%;">ä¿®æ”¹æ—¥æœŸ</div>
                <div class="folder-list-col type-col" style="width: 20%;">ç±»å‹</div>
                <div class="folder-list-col size-col" style="width: 20%; text-align: right;">å¤§å°</div>
            </div>

            <!-- æ–‡ä»¶é¡¹ -->
            <div class="folder-list-body">
                @for (file of files; track file.path) {
                    <div role="row" tabindex="0"
                         class="folder-list-row"
                         [class.selected]="isFileSelected(file)"
                         (click)="onFileClick(file, $event)"
                         (dblclick)="fileDbl(file)"
                         (contextmenu)="onRightClick($event, file)">
                        <div role="gridcell" class="folder-list-col name-col">
                            @if (file.isDirectory) {
                                ğŸ“ {{ file.name }}
                            } @else {
                                ğŸ“„ {{ file.name }}
                            }
                        </div>
                        <div role="gridcell" class="folder-list-col modified-col">
                            {{ file.lastModified | date:'yyyy-MM-dd HH:mm' }}
                        </div>
                        <div role="gridcell" class="folder-list-col type-col">
                            {{ getFileType(file) }}
                        </div>
                        <div role="gridcell" class="folder-list-col size-col" style="text-align: right;">
                            @if (file.isDirectory) {
                                --
                            } @else {
                                {{ formatSize(file.size) }}
                            }
                        </div>
                    </div>
                }
            </div>
        </div>
        <div (contextmenu)="onWrapperRightClick($event)">

        </div>
    </div>
    @if(contextMenuVisible && this.selectedFiles.length>0){
        <ul
            class="context-menu"
            [style.top.px]="contextMenuPosition.y"
            [style.left.px]="contextMenuPosition.x"
            (click)="$event.stopPropagation()">
            <li>
                <button (click)="onContextMenuAction('openCode')">
                    é€šè¿‡code spaceæ‰“å¼€
                </button>
            </li>
            @if(this.selectedFiles.length === 1 && this.selectedFiles[0].isDirectory){
                <li>
                    <button (click)="onContextMenuAction('openTerminal')">åœ¨ç»ˆç«¯ä¸­æ‰“å¼€</button>
                </li>
            }
            <li>
                <button (click)="onContextMenuAction('properties')">
                    å±æ€§
                </button>
            </li>

            <li>
                <button (click)="copyFile()">
                    å¤åˆ¶
                </button>
            </li>

            <li>
                <button (click)="cutFile()">
                    å‰ªåˆ‡
                </button>
            </li>

            <li>
                <button (click)="onContextMenuAction('copyPath')">
                    å¤åˆ¶æ–‡ä»¶åœ°å€
                </button>
            </li>
        </ul>
    }
    @if(contextMenuVisible && this.selectedFiles.length===0){
        <ul class="context-menu"
            [style.top.px]="contextMenuPosition.y"
            [style.left.px]="contextMenuPosition.x"
            (click)="$event.stopPropagation()">
            <li>
                <button [class.disabled]="!canPaste" (click)="pasteFile()" [disabled]="!canPaste">ç²˜è´´</button>
            </li>
            <li>
                <button (click)="onContextMenuAction('refresh')">åˆ·æ–°</button>
            </li>
            <li>
                <button (click)="onContextMenuAction('openTerminal')">åœ¨ç»ˆç«¯ä¸­æ‰“å¼€</button>
            </li>
        </ul>
    }
</div>
