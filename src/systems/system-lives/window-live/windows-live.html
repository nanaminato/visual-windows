@if(win){
    <div [id]="win.id"
         class="window"
         [style.left.px]="win.position.x"
         [style.top.px]="win.position.y"
         [style.width.px]="win.size.width"
         [style.height.px]="win.size.height"
         [class.disabled]="win.disabled"
         (tap)="focusWindow(win.id)"
         (mousedown)="focusWindow(win.id)">
        <div [class.disabled-overlay]="win.disabled"
             (click)="focusWindow(win.id!)"
             (mousedown)="focusWindow(win.id!)"
             (tap)="focusWindow(win.id!)">
        </div>

        <div class="title-bar"
             [class.active]="win.active"
             [hidden]="win.customHeader">
            <div class="d-flex flex-row">
                <app-win-icon [programConfig]="config"></app-win-icon>
                <span class="mx-1">{{win.title}}</span>
            </div>
            <div class="flex-grow-1 h-100"
                 (mousedown)="startDrag($event, win.id)"
                 (touchstart)="touchDrag($event, win.id)">
            </div>
            <div class="d-flex flex-row">
                @if(!win.modal){
                    <button class="mini-btn" >
                        <nz-icon nzType="line" style="font-size: 14px" nzTheme="outline"
                                 (click)="minimizeWindow(win.id)"
                        />
                    </button>
                }

                <button class="max-btn" >
                    <nz-icon nzType="border" style="font-size: 14px" nzTheme="outline"
                             (click)="maximizeWindow(win.id)"
                    />
                </button>
                <button class="close-btn" (click)="closeWindow(win.id)"
                >Ã—</button>
            </div>
        </div>
        <div class="content">
            @if(win.component){
                <ng-template #dynamicContent></ng-template>
            }
        </div>
        @if(!win.maximized){
            <div class="resize-handle top-left" (mousedown)="startResize($event, win.id, 'top-left')"  (touchstart)="startResize($event, win.id, 'top-left')"></div>
            <div class="resize-handle top" (mousedown)="startResize($event, win.id, 'top')" (touchstart)="startResize($event, win.id, 'top')"></div>
            <div class="resize-handle top-right" (mousedown)="startResize($event, win.id, 'top-right')" (touchstart)="startResize($event, win.id, 'top-right')"></div>
            <div class="resize-handle right" (mousedown)="startResize($event, win.id, 'right')" (touchstart)="startResize($event, win.id, 'right')"></div>
            <div class="resize-handle bottom-right" (mousedown)="startResize($event, win.id, 'bottom-right')" (touchstart)="startResize($event, win.id, 'bottom-right')"></div>
            <div class="resize-handle bottom" (mousedown)="startResize($event, win.id, 'bottom')" (touchstart)="startResize($event, win.id, 'bottom')"></div>
            <div class="resize-handle bottom-left" (mousedown)="startResize($event, win.id, 'bottom-left')" (touchstart)="startResize($event, win.id, 'bottom-left')"></div>
            <div class="resize-handle left" (mousedown)="startResize($event, win.id, 'left')" (touchstart)="startResize($event, win.id, 'left')"></div>
        }
    </div>
}
